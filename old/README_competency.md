# –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GigaChat

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ—Ä–∞–∑ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞ —Å —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏ –∏–∑ Excel —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ API GigaChat.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏–∑ Excel —Ñ–∞–π–ª–∞
- üìù –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ—Ä–∞–∑ –∏–∑ DOCX —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞
- ü§ñ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ GigaChat API
- üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- üéØ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä–æ–≥ —Å—Ö–æ–¥—Å—Ç–≤–∞
- üìã –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CSV –∏ JSON

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements_competency.txt
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `config.py`:
```python
GIGACHAT_API_KEY = "–≤–∞—à_api_–∫–ª—é—á_–∑–¥–µ—Å—å"
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

- `triggers.xlsx` - Excel —Ñ–∞–π–ª —Å —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏
  - –ö–æ–ª–æ–Ω–∫–∞ `trigger_text` - —Ç–µ–∫—Å—Ç —Ç—Ä–∏–≥–≥–µ—Ä–∞
  - –ö–æ–ª–æ–Ω–∫–∞ `competency` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏
  - –ö–æ–ª–æ–Ω–∫–∞ `score` - –±–∞–ª–ª –∑–∞ —Ç—Ä–∏–≥–≥–µ—Ä

- `trans.docx` - DOCX —Ñ–∞–π–ª —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–º

### –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É `results/`:
- `matches_YYYYMMDD_HHMMSS.csv` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
- `summary_YYYYMMDD_HHMMSS.csv` - —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
- `summary_YYYYMMDD_HHMMSS.json` - JSON –æ—Ç—á–µ—Ç
- `stats_YYYYMMDD_HHMMSS.json` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑

```python
import asyncio
from competency_analyzer_advanced import AdvancedCompetencyAnalyzer

async def main():
    async with AdvancedCompetencyAnalyzer() as analyzer:
        # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        triggers = analyzer.load_triggers("triggers.xlsx")
        phrases = analyzer.load_phrases("trans.docx")
        
        # –ê–Ω–∞–ª–∏–∑
        matches = await analyzer.analyze_competencies(phrases, triggers)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
        summary = analyzer.create_summary(matches)
        analyzer.save_results(matches, summary)

asyncio.run(main())
```

### –ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```bash
python competency_analyzer_advanced.py
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config.py`:

```python
# API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
GIGACHAT_API_KEY = "–≤–∞—à_–∫–ª—é—á"
GIGACHAT_API_URL = "https://gigachat.devices.sberbank.ru/api/v1/chat/completions"

# –§–∞–π–ª—ã
TRIGGERS_FILE = "triggers.xlsx"
TRANSCRIPT_FILE = "trans.docx"

# –ü–æ—Ä–æ–≥ —Å—Ö–æ–¥—Å—Ç–≤–∞ (0-100)
SIMILARITY_THRESHOLD = 85

# –ü–∞–ø–∫–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
OUTPUT_DIR = "results"
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –∏–∑ Excel
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ—Ä–∞–∑ –∏–∑ DOCX

2. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**
   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã (—Ñ—Ä–∞–∑–∞, —Ç—Ä–∏–≥–≥–µ—Ä)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ GigaChat API
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ (0-100)

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**
   - –û—Ç–±–æ—Ä —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å score >= –ø–æ—Ä–æ–≥

4. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è**
   - –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ –ø–æ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏—è–º
   - –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫

5. **–≠–∫—Å–ø–æ—Ä—Ç**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
   - –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
- **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å–±–æ—è–º API
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ

## –ü—Ä–∏–º–µ—Ä—ã –æ—Ç—á–µ—Ç–æ–≤

### –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
```
competency          total_score  avg_score  avg_similarity  max_similarity  matches_count  percentage
–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è        45.0         15.0       87.5           95              3              60.0
–õ–∏–¥–µ—Ä—Å—Ç–≤–æ           30.0         15.0       88.0           92              2              40.0
```

### –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
```
phrase                    trigger                    competency    score  similarity
"–Ø –≤—Å–µ–≥–¥–∞ —Å–ª—É—à–∞—é..."     "–ê–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ"        –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è  15     95
"–í –∫–æ–º–∞–Ω–¥–µ —è..."         "–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞"          –õ–∏–¥–µ—Ä—Å—Ç–≤–æ     15     88
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- pandas
- aiohttp
- python-docx
- openpyxl

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞ (–Ω—É–∂–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏)
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫ 